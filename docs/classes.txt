@startuml
KeyServer o-- Comitter
KeyServer o-- Queuer
KeyServer o-- Authenticator
KeyServer o-- Mutator
KeyServer o-- SparseTree
KeyServer o-- Reader

Signer o-- Sequencer
Signer o-- Appender
Signer o-- Mutator
Signer o-- SparseTree

SparseTreeHist <|-- SparseTree
OAuth <|-- Authenticator
HashChain <|-- Appender
CTLog <|-- Appender
Replacer <|-- Mutator
MemTree <|-- SparseTree
SpannerTree <|-- SparseTree

SparseTree : WriteLeaf
SparseTree : ReadLeaf
SparseTree : ReadRoot

SparseTreeHist : ReadLeafAt

MemDB <|-- Queuer
MemDB <|-- Sequencer
MemDB <|-- Reader
MemDB <|-- Writer
MemDB <|-- Comitter
MemDB : QueueMutation()
MemDB : Queue()
MemDB : WriteCommitment()
MemDB : ReadCommitment()
MemDB : WriteLeaf
MemDB : ReadLeaf
MemDB : WriteNodes
MemDB : ReadNodes

KeyServer : GetEntry()
KeyServer : UpdateEntry()

Comitter : WriteCommitment(commitment, key, data)
Comitter : ReadCommitment(commitment)

Queuer : QueueMutation(index, mutation)

Mutator : CheckMutation(value, mutation)
Mutator : Mutate(value, mutation)

Sequencer : Queue() <-chan Mutation

Reader : ReadPath
Reader : ReadLeaf

@enduml
