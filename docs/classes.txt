@startuml
interface Committer 
interface Queuer
interface Authenticator 
interface Mapper 
interface SparseTree 
interface SparseTreeHist
interface Reader 
interface Writer
interface Appender 
interface RW 
interface Sequencer

RW o-- Reader
RW o-- Writer

KeyServer o-- Committer
KeyServer o-- Queuer
KeyServer o-- Authenticator
KeyServer o-- Mapper
KeyServer o-- SparseTree
KeyServer o-- Reader
KeyServer o-- Appender : Reads STHs

Signer o-- Sequencer
Signer o-- Appender
Signer o-- Mapper
Signer o-- SparseTree

SparseTreeHist <|-- SparseTree
OAuth <|-- Authenticator
HashChain <|-- Appender
CTLog <|-- Appender
Replacer <|-- Mapper
MemTree <|-- SparseTree
SpannerTree <|-- SparseTree

SparseTree : WriteLeaf
SparseTree : ReadLeaf
SparseTree : ReadRoot

SparseTreeHist : ReadLeafAt

MemDB <|-- Queuer
MemDB <|-- Sequencer
MemDB <|-- RW
MemDB <|-- Committer
MemDB : QueueMutation()
MemDB : Queue()
MemDB : WriteCommitment()
MemDB : ReadCommitment()
MemDB : WriteLeaf
MemDB : ReadLeaf
MemDB : WriteNodes
MemDB : ReadNodes

KeyServer : GetEntry()
KeyServer : UpdateEntry()

Committer : WriteCommitment(commitment, key, data)
Committer : ReadCommitment(commitment)

Queuer : QueueMutation(index, mutation)

Mapper : CheckMutation(value, mutation)
Mapper : Mutate(value, mutation)

Sequencer : Queue() <-chan Mutation

Reader : ReadPath
Reader : ReadLeaf

Appender : Append(timestamp int64, data []byte) error
Appender : GetHLast() ([]byte, error)
Appender : GetItem(index int64) ([]byte, error)
Appender : GetByTimeStamp(timestamp int64) ([]byte, error)

@enduml
